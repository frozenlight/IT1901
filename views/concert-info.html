{% extends "index.html" %}
{% block head %}
	{% parent %}
	<link rel="stylesheet" type="text/css" href="/css/tablestyle.css" />
{% endblock %}
{% block content %}
    
    <!--<div class="col-xs-3">
    <div class="thumbnail">
                        {% for stage in concert.stage %}
						<img src="{{stage.image}}"/>
                        {% endfor %}
					</div>
</div>
    <div class="col-xs-3">
    <div class="thumbnail">
                        {% for band in concert.bands %}
						<img src="{{band.spotify_image}}"/>
                        {% endfor %}
</div>
</div>
-->
	<div class="container text-left">

		

		<div class="col-xs-8">
			<h2 style="color: #a03033">{{concert.name}}</h2>
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Info</h3>
				</div>
				<div class="panel-body">
					<p>Dato og tid: &nbsp;&nbsp;&nbsp;&nbsp; 
                        {{concert.date}}, {{concert.time}} </p>
					<p>Scene: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;&nbsp; 
                        <a href="/stage/{{concert.stage.name}}">{{concert.stage.name}}</a> </p>
					
                    Band: 
					<ul id="concert_band_list">
                        &nbsp; &nbsp; 
						{% for band in concert.bands %}
							<li><a href="/band/{{ band.name }}">{{band.name}}</a></li>
						{% endfor %}
					</ul>

					
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Info</h3>
				</div>
				<div class="panel-body">
					{{band.description}}
				</div>
			</div>
			{% if userIs('band') %}
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Info for Band</h3>
				</div>
				<div class="panel-body">
					<h4>Lydprøve</h4>
					<p>Dato:	{{concert.date}}</p>
					<p>Tid:		{{concert.practice_time}}</p>
					<h4>Kontaktperson</h4>
					<p>{{concert.host}}</p>
				</div>
			</div>
			{% endif %}
            <div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Publikum</h3>
				</div>
				<div class="panel-body">
					{{concert.audSize}}
				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Tidligere konserter i Norge</h3>
				</div>
				<div class="panel-body">
					<ul>
					{% for concert in band.previous_concerts %}
						<li>{{concert}}</li>
					{% endfor %}
					</ul>
				</div>
			</div>
			{% if band.spotify_top_tracks %}
			<h2 class="tableHeader">Top 10 songs on Spotify</h2>

			<!--<form method="POST" action="/band/{{ band.name }}">-->

			<table data-toggle="table" 
			data-classes="table table-hover results"
			data-striped="true"
			data-sort-name="Name"
			data-sort-order="asc">
				<thead>
					<tr>
						<th class="col-xs-2" data-field="Name" data-sortable="true">Navn</th>
						<th class="col-xs-2" data-field="Album" data-sortable="true">Album</th>
						<th class="col-xs-1" data-field="Popularity" data-sortable="true">Popularitet</th>
						<th class="col-xs-1" data-field="Preview" data-sortable="false">Smakebit</th>
					</tr>
				</thead>

				<tbody>
					{% for track in band.spotify_top_tracks %}
					<tr>
						<td>{{ track.name }}</td>
						<td>{{ track.album }}</td>
						<td>{{ track.popularity }}</td>
						<td><audio controls><source src="{{track.preview_url}}" type="audio/mpeg">Not supported</source></td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
			{% endif %}

			{% if band.concerts %}

			<h2 class="tableHeader">Tidligere konserter på Samfundet</h2>

			<!--<form method="POST" action="/band/{{ band.name }}">-->

			<table data-toggle="table" 
			data-classes="table table-hover results"
			data-striped="true"
			data-sort-name="Date"
			data-sort-order="asc">
				<thead>
					<tr>
						<th class="col-xs-2" data-field="Date" data-sortable="true">Dato</th>
						<th class="col-xs-1" data-field="Name" data-sortable="false">Navn</th>
						<th class="col-xs-1" data-field="Genres" data-sortable="true">Sjangre</th>
						<th class="col-xs-1" data-field="AudSize" data-sortable="false">Deltakere</th>
						<th class="col-xs-1" data-field="Stage" data-sortable="true">Scene</th>
					</tr>
				</thead>

				<tbody>
					{% for concert in band.concerts %}
					<tr>
						<td>{{ concert.date }}</td>
						<td>{{ concert.name }}</td>
						<td>{% for genre in concert.genres %}{{ genres }}, {% endfor %}</td>
						<td>{{ concert.audSize }}</td>
						<td>{{ concert.stage.name }}</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
			{% endif %}

			{% if band.bookings %}

			<h2 class="tableHeader">Bookings på Samfundet</h2>

			<!--<form method="POST" action="/band/{{ band.name }}">-->

			<table data-toggle="table" 
			data-classes="table table-hover results"
			data-striped="true"
			data-sort-name="Date"
			data-sort-order="asc">
				<thead>
					<tr>
						<th class="col-xs-1" data-field="Date" data-sortable="true">Dato</th>
						<th class="col-xs-2" data-field="Pris" data-sortable="true">Pris</th>
						<th class="col-xs-2" data-field="Status" data-sortable="true">Status</th>
					</tr>
				</thead>

				<tbody>
					{% for booking in band.bookings %}
					<tr>
						<td>{{ booking.date }}</td>
						<td>{{ booking.price }}</td>
						<td>
							{% if !booking.considered %}
								Venter godkjenning
							{% elseif booking.approval %}
								Godkjent
							{% else %}
								Avslått
							{% endif %}
						</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
			{% endif %}

            
		</div>

		<div class="col-xs-4">

   		<a class="btn btn-success align-buttons" href='/concert/{{ concert.name }}/edit'>Endre konsert</a>

		<form method="POST" action="/concert/{{ concert.name }}" class="align-buttons">

			<input type="hidden" name="_method" value="DELETE"/>
			<input type="submit" class="btn btn-danger" value="Slett"/><br>
		</form>         
			<div class="panel panel-default">
                {% for band in concert.bands %}
						
				<div class="panel-heading">
					<h3 class="panel-title">Statistikk</h3>
				</div>
				<div class="panel-body">
					<div class="thumbnail">
						<img src="{{band.spotify_image}}"/>
					</div>
					<table>
						<tbody>
							<tr>
								<td>Popularitetsrate:</td>
								<td>&nbsp {{band.spotify_popularity}}</td>
							</tr>
							<tr>
								<td>Spotify-følgere:</td>
								<td>&nbsp {{band.spotify_followers}}</td>
							</tr>
							<tr>
								<td>Avspillingsantall (Lastfm):</td>
								<td>&nbsp {{band.lastfm_playcount}}</td>
							</tr>
							<tr>
								<td>Lytterantall (Lastfm):</td>
								<td>&nbsp {{band.lastfm_listeners}}</td>
							</tr>
						</tbody>
					</table>
				</div>
                
                        {% endfor %}
			</div>
            

<!--
            <div class="panel panel-default">
                {% if stage in concert.stage %}
						
				<div class="panel-heading">
					<h3 class="panel-title">{{stage.name}}</h3>
				</div>
				<div class="panel-body">
					<div class="thumbnail">
						<img src="{{stage.image}}"/>
					</div>
                </div>
                {% endif %}
            </div>
            -->
            
			{% if band.spotify_albums %}
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Albumer</h3>
				</div>
				<div class="panel-body">
					
					<table data-toggle="table" 
					data-classes="table table-hover results"
					data-striped="true"
					data-sort-name="Name"
					data-sort-order="asc">

						<tbody>
							{% for album in band.spotify_albums %}
							<tr>
								<td><img height="64" width="64" src="{{album.image}}"></img></td>
								<td>{{album.name}}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
			{% endif %}
		</div>
	</div>
{% endblock %}
